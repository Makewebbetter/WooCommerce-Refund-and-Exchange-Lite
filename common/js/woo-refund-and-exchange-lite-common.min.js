jQuery(document).on("ready",(function(){$=jQuery,$("#order_refunds").length&&$("#order_refunds").find(".refund").each((function(){var r={action:"mwb_rma_refund_info",refund_id:$(this).data("order_refund_id"),security_check:wrael_common_param.mwb_rma_nonce},e=$(this);$.ajax({url:wrael_common_param.ajaxurl,type:"POST",data:r,success:function(r){r||e.hide()}})})),$(".mwb_rma_return_notification").hide(),$("#mwb_rma_return_request_form").on("submit",(function(r){r.preventDefault();var e=$(this).data("orderid"),_=$(".mwb_rma_total_refund_price").val(),a="",o={},t=0,m="",n=wrael_common_param.check_pro_active,c=$("#mwb_rma_return_request_subject").val();""!=c&&null!=c||""!=(c=$("#mwb_rma_return_request_subject_text").val())&&null!=c&&c.match(/[[A-Za-z]/i)||(a+="<li>"+wrael_common_param.return_subject_msg+"</li>");var s=$(".mwb_rma_return_request_reason").val();if(""!=s&&null!=s&&s.match(/[[A-Za-z]/i)||(a+="<li>"+wrael_common_param.return_reason_msg+"</li>"),n&&"function"==typeof mwb_rma_return_alert_condition_addon){var d=mwb_rma_return_alert_condition_addon();d&&(a+=d)}if(""!=a)return $("#mwb_rma_return_alert").html(a),$("#mwb_rma_return_alert").addClass("woocommerce-error"),$("#mwb_rma_return_alert").removeClass("woocommerce-message"),$("#mwb_rma_return_alert").css("background-color","red"),$("html, body").animate({scrollTop:$("#mwb_rma_return_request_container").offset().top},800),!1;if($("#mwb_rma_return_alert").hide(),$("#mwb_rma_return_alert").html(a),n){if("function"==typeof mwb_rma_refund_total){var i=mwb_rma_refund_total();o=i.selected_product,_=i.amount}}else $(".mwb_rma_return_column").each((function(){if($(this).find("td:eq(0)").children(".mwb_rma_return_product")){var r={},e=$(this).data("variationid"),_=$(this).data("productid"),a=$(this).data("itemid"),m=$(this).find("td:eq(0)").children(".mwb_rma_product_amount").val(),n=$(this).find("td:eq(1)").children(".mwb_rma_return_product_qty").val();r.product_id=_,r.variation_id=e,r.item_id=a,r.price=m,r.qty=n,o[t]=r,t++}}));n&&"function"==typeof mwb_rma_refund_method&&(m=mwb_rma_refund_method());var u={action:"mwb_rma_save_return_request",products:o,amount:_,subject:c,reason:s,orderid:e,bankdetails:$("#mwb_rma_bank_details").val(),refund_method:m,security_check:wrael_common_param.mwb_rma_nonce},l=new FormData(this);l.append("action","mwb_rma_return_upload_files"),l.append("security_check",wrael_common_param.mwb_rma_nonce),$(".mwb_rma_return_notification").show(),$.ajax({url:wrael_common_param.ajaxurl,type:"POST",data:l,contentType:!1,cache:!1,processData:!1,success:function(r){$.ajax({url:wrael_common_param.ajaxurl,type:"POST",data:u,dataType:"json",success:function(r){if(window.location.href.indexOf("refund-request-form")>-1){var _=10;setInterval((function(){_>=0&&$("#countdownTimer").html(_),_-=1}),1e3)}$("#mwb_rma_return_alert").removeClass("woocommerce-error"),$("#mwb_rma_return_alert").addClass("woocommerce-message"),$("#mwb_rma_return_alert").css("background-color","#8FAE1B"),$("#mwb_rma_return_alert").show(),$("#mwb_rma_return_alert").html(r.msg+' in <b><span id="countdownTimer"></span> seconds</b>'),$(".mwb_rma_return_notification").hide(),$("html, body").animate({scrollTop:$(".woocommerce-breadcrumb").offset().top},800),void 0!==r.auto_accept&&1==r.auto_accept?"function"==typeof mwb_rma_refund_auto_accept&&mwb_rma_refund_auto_accept(e):window.setTimeout((function(){window.location.href=wrael_common_param.myaccount_url}),11e3)}})}})})),$(document).on("click",".mwb_remove_notice_msg",(function(r){r.preventDefault(),$(".mwb_order_msg_notice_wrapper").hide()})),$(document).on("click","#mwb_order_msg_submit",(function(r){r.preventDefault();var e=$("#mwb_order_msg_attachment"),_=$("#mwb_order_new_msg").val(),a=$("#order_msg_type").val(),o="";if(""==_)return o='<p class="mwb_order_msg_sent_notice">'+wrael_common_param.message_empty+'</p><a href="" class="mwb_remove_notice_msg">X</a>',$(".mwb_order_msg_notice_wrapper").css("display","flex"),$(".mwb_order_msg_notice_wrapper").css("background-color","red"),$(".mwb_order_msg_notice_wrapper").html(o),$("#mwb_order_msg_submit").css({"outline-color":"white","border-color":"white"}),!1;for(var t=$(this).data("id"),m=new FormData,n=e[0].files.length,c=0;c<n;c++)m.append("mwb_order_msg_attachment[]",e[0].files[c]);m.append("action","mwb_rma_order_messages_save"),m.append("msg",_),m.append("order_msg_type",a),m.append("order_id",t),m.append("security_check",wrael_common_param.mwb_rma_nonce),$.ajax({url:wrael_common_param.ajaxurl,type:"post",data:m,dataType:"json",contentType:!1,processData:!1,success:function(r){if(r){var e='<p class="mwb_order_msg_sent_notice">'+wrael_common_param.message_sent+'</p><a href="" class="mwb_remove_notice_msg">X</a>';$(".mwb_order_msg_notice_wrapper").css("background-color","#64CD83"),$(".mwb_order_msg_notice_wrapper").css("display","flex"),$("#mwb_order_msg_submit").css({"outline-color":"none","border-color":"none"}),$(".mwb_order_msg_sub_container").load(document.URL+" .mwb-order-msg__row"),$("#mwb_order_new_msg").val(""),$("#mwb_order_msg_attachment").val(""),$(".mwb_order_msg_notice_wrapper").html(e)}}})})),$(".mwb_order_msg_reload_notice_wrapper").hide(),$(document).on("click",".mwb_reload_messages",(function(r){r.preventDefault(),$(this).addClass("mwb-loader-icon"),$(".mwb_order_msg_sub_container").load(document.URL+" .mwb-order-msg__row"),setTimeout((function(){$(".mwb_reload_messages").removeClass("mwb-loader-icon"),$(".mwb_order_msg_reload_notice_wrapper").show(),$(".mwb_order_msg_reload_notice_wrapper").css({"background-color":"rgb(100, 205, 131)","border-radius":"5px",color:"white","padding-left":"10px"})}),2e3),setTimeout((function(){$(".mwb_order_msg_reload_notice_wrapper").hide()}),3e3)})),$(document).on("click",".mwb_order_send_msg_dismiss",(function(r){r.preventDefault(),$(".mwb_order_msg_notice_wrapper").hide()}))}));